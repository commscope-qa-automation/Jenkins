properties([
    parameters([
        string(
            defaultValue: 'Jenkins_Robot_Results', 
            name: 'OutputDir',
            description: 'Relative directory to the workspace. The directory contains the Robot Framework output files: log.html, report.html, output.xml, xunit.xml.',
            trim: true
        ),
        string(
            defaultValue: 'TestData_Custom', 
            name: 'TestDataDir',
            description: 'Relative directory to the workspace. The directory contains test data files.',
            trim: true
        ),
        string(
            defaultValue: 'All_TestData', 
            name: 'TestDataFileName',
            description: 'Test data file name.',
            trim: true
        ),    
        choice(
            name: 'Utility',
            choices: ['Configure Device After Factory Reset',
            'Configure Device LAN IP Via ECO API',
            'Capture Packets On RG Gateway',
            'Capture Packets On AWS Servers'
            ],
            description: 'Please choose the utility:'
        )
    ])
])  

pipeline {
    agent { 
        label {
            label 'robot_windows'
        }
    }
    
    stages {
       stage ("Check out scripts") {
            steps {
                git credentialsId: 'github_creds', url: 'https://github.com/commscope-qa-automation/RobotProject.git'
            }
        }
        
        stage ("Run scripts") {
            steps {
                bat '''robot -t "%Utility%" --outputdir %OutputDir% --log Utility_log_1.html --output Utility_output_1.xml --report Utility_report_1.html --variablefile ../../%TestDataDir%/%TestDataFileName%.py ECOManageRobotProject/TestSuite_ECOManage/Utility.robot
                echo Completed!'''
            }
        }
    }
}